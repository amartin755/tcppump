# SPDX-License-Identifier: GPL-3.0-only
###############################################################################
#
# TCPPUMP <https://github.com/amartin755/tcppump>
# Copyright (C) 2012-2020 Andreas Martin (netnag@mailbox.org)
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, version 3.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program. If not, see <http://www.gnu.org/licenses/>.
#
###############################################################################


# tcppump tests
###############################################################################
enable_testing()

if (WIN32)
    set (OUT_IFC "Ethernet") #FIXME we need a reliable way to find a suitable test interface in windows
endif ()
if (UNIX)
    set (OUT_IFC lo)
endif ()
if (TEST_NET_ADAPTER)
    set (OUT_IFC ${TEST_NET_ADAPTER})
endif ()

message(STATUS "Using network adapter '${OUT_IFC}' for ctest")

set (TEST_OUTPUT testoutput.pcap)
set (DEFAULT_PARAMS_NO_MTU -i ${OUT_IFC} --predictable-random --myip4=1.2.3.4 --mymac=80:23:45:67:89:AB -o ${TEST_OUTPUT})
set (DEFAULT_PARAMS ${DEFAULT_PARAMS_NO_MTU} --mtu 1500)
set (TEST_FILE_PREFIX ${CMAKE_BINARY_DIR}/../src/test)


add_test(NAME no-params--nok COMMAND tcppump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(no-params--nok PROPERTIES WILL_FAIL TRUE)

add_test(NAME show-usage--ok COMMAND tcppump -h WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME show-version--ok COMMAND tcppump --version WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME show-version-output--ok COMMAND tcppump --version WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(show-version-output--ok PROPERTIES PASS_REGULAR_EXPRESSION "version ${PROJECT_VERSION}")

add_test(NAME raw-1--ok COMMAND tcppump ${DEFAULT_PARAMS} "raw(payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME raw-1--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/raw-01.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME raw-2--nok COMMAND tcppump ${DEFAULT_PARAMS} "raw(payload = abcdf)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(raw-2--nok PROPERTIES WILL_FAIL TRUE)

add_test(NAME eth-1--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-1--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-01.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-2--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=1122:33:44:55:66, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-2--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-3--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, ethertype=0x9000, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-3--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-03.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-4--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, ethertype=0x10000, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-4--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-5--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-5--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-6--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, smac=80:81:82:83:84:85, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-6--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-06.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-7--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-7--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-8--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-8--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-08.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-9--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4096, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-9--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-10--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, prio=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-10--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-08.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-11--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, prio=7, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-11--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-11.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-12--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, prio=8, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-12--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-13--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, prio=7, dei=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-13--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-11.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-14--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, prio=7, dei=1, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-14--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-14.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-15--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, prio=7, dei=2, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-15--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-16--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, prio=7, dei=1, vtype=1, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-16--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-14.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-17--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, prio=7, dei=1, vtype=2, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-17--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-17.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-18--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, prio=7, dei=1, vtype=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-18--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-19--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, prio=7, dei=1, vtype=3, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-19--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-20--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=4095, prio=3, ethertype=0x9000, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-20--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-20.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-21--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=1, vid=4095, prio=3, ethertype=0x9000, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-21--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-21.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-22--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=1, vtype=2, vid=4095, prio=3, ethertype=0x9000, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-22--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-22.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-23--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, dsap=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-23--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-24--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, dsap=0, ssap=0xff, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-24--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-24.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-25--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, dsap=255, ssap=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-25--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-25.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-26--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, dsap=255, ssap=0, control=3, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-26--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-25.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-27--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, dsap=255, ssap=0, control=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-27--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-27.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-28--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, dsap=255, ssap=0, control=0xffff, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-28--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-28.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-29--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, dsap=255, ssap=0, control=0x10000, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-29--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-30--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, dsap=256, ssap=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-30--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-31--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, dsap=0, ssap=256, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-31--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-32--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, dsap=255, ssap=0, control=0xffff, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-32--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-28.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-33--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=42, dsap=255, ssap=0, control=0xffff, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-33--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-33.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-34--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, oui=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-34--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-35--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, oui=0, protocol=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-35--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-35.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-36--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, oui=0xffffff, protocol=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-36--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-36.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-37--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, oui=0x654321, protocol=0xffff, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-37--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-37.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-38--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, oui=0x654321, protocol=0x10000, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-38--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME eth-39--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, vid=1, vid=2, oui=0x654321, protocol=0xffff, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-39--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-39.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-40--ok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, ethertype=0x8000, payload = \"There's no place like 127.0.0.1\")" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-40--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/eth-40.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME eth-41--nok COMMAND tcppump ${DEFAULT_PARAMS} "eth(dmac=11:22:33:44:55:66, ethertype=0x9000, dsap=255, ssap=0, control=0xffff, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(eth-41--nok PROPERTIES WILL_FAIL TRUE)

add_test(NAME arp-1--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-1--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-01.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-2--nok COMMAND tcppump ${DEFAULT_PARAMS} "arp(dip=10.20.30.40.50)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(arp-2--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME arp-3--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp(dip=10.20.30.40, op=1)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-3--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-01.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-4--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp(dip=10.20.30.40, op=2)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-4--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-04.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-5--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp(dip=10.20.30.40, op=0xffff)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-5--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-05.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-6--nok COMMAND tcppump ${DEFAULT_PARAMS} "arp(dip=10.20.30.40, op=0x10000)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(arp-6--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME arp-7--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp(dip=10.20.30.40, smac=80:81:82:83:84:85)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-7--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-8--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp(dip=10.20.30.40, sip=11.22.33.44)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-8--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-08.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-9--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp(dip=10.20.30.40, dmac=80:81:82:83:84:85)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-9--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-09.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-10--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp(op=2, dip=10.20.30.40, dmac=80:81:82:83:84:85, smac=90:91:92:93:94:95, sip=11.22.33.44)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-10--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-10.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-11--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp(dip=10.20.30.40, vid=42, prio=5, dei=1)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-11--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-11.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-12--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp-probe(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-12--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-12.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-13--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp-announce(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-13--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-13.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-14--ok COMMAND tcppump ${DEFAULT_PARAMS} "arp-announce()" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME arp-14--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/arp-14.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})

add_test(NAME ipv4-1--nok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(ipv4-1--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME ipv4-2--nok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(ipv4-2--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME ipv4-3--nok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(ipv4-3--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME ipv4-4--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-4--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-04.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-5--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-5--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-05.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-6--nok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=256, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(ipv4-6--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME ipv4-6--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, dscp=0, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-6--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-04.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-7--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, dscp=0x3f, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-7--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-8--nok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, dscp=0x40, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(ipv4-8--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME ipv4-9--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, dscp=0x3f, ecn=0, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-9--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-10--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-10--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-10.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-11--nok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, dscp=0x0, ecn=4, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(ipv4-11--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME ipv4-12--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, ttl=64, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-12--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-10.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-13--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, ttl=0, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-13--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-13.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-14--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, ttl=255, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-14--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-14.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-15--nok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, ttl=256, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(ipv4-15--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME ipv4-16--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, df=0, ttl=255, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-16--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-14.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-17--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, df=1, ttl=255, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-17--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-17.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-18--nok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, df=2, ttl=255, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(ipv4-18--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME ipv4-19--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, smac=90:91:92:93:94:95, dmac=11:22:33:44:55:66, df=1, ttl=255, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-19--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-19.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-20--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(sip=11.22.33.44, dip=10.20.30.40, smac=90:91:92:93:94:95, dmac=11:22:33:44:55:66, df=1, ttl=255, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-20--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-20.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-21--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(vid=42, prio=4, sip=11.22.33.44, dip=10.20.30.40, smac=90:91:92:93:94:95, dmac=11:22:33:44:55:66, df=1, ttl=255, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-21--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-21.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-22--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=224.20.30.40, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-22--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-22.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-23--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=224.20.30.40, dmac=11:22:33:44:55:66, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-23--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-23.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-24--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=255, payload = \"There's no place like 127.0.0.1\")" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-24--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-24.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-25--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=255, id=0, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-25--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-25.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-26--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=255, id=65535, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-26--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-26.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-27--nok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=255, id=65536, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(ipv4-27--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME ipv4-28--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=255, id=1, payload = *1480)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-28--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-28.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-29--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=255, id=1, payload = *1481)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-29--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-29.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-30--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=255, id=1, payload = *2961)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-30--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-30.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-31--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=255, id=1, payload = *65515)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-31--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-31.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-32--nok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, protocol=255, id=1, payload = *65516)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(ipv4-32--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME ipv4-33--ok COMMAND tcppump ${DEFAULT_PARAMS} "ipv4(dip=10.20.30.40, dmac=11:22:33:44:55:66, df, ttl=255, dscp=0x0, ecn=3, protocol=255, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME ipv4-33--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/ipv4-17.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})

add_test(NAME udp-1--nok COMMAND tcppump ${DEFAULT_PARAMS} "udp()" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(udp-1--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME udp-2--nok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dmac=11:22:33:44:55:66)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(udp-2--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME udp-3--nok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(udp-3--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME udp-4--nok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(udp-4--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME udp-5--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-5--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-05.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-6--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0xffff, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-6--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-06.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-7--nok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0x10000, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(udp-7--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME udp-8--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0xffff)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-8--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-08.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-9--nok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0x10000)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(udp-9--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME udp-10--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, chksum=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-10--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-10.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-11--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, chksum=0xffff)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-11--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-11.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-12--nok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, chksum=0x10000)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(udp-12--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME udp-13--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, chksum=0xffff,  payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-13--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-13.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-14--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-14--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-14.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-15--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(sip=11.22.33.44, smac=90:91:92:93:94:95, dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-15--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-15.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-16--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dscp=42, ecn=2, ttl=10, df=1, sip=11.22.33.44, smac=90:91:92:93:94:95, dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-16--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-16.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-17--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(vid=42, vtype=2, dei=1, prio=4, vid=43, prio=5, dscp=42, ecn=2, ttl=10, df=1, sip=11.22.33.44, smac=90:91:92:93:94:95, dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-17--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-17.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-18--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=224.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-18--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-18.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-19--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=224.20.30.40, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-19--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-19.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-20--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=224.20.30.40, sport=0, dport=0, payload=\"There's no place like 127.0.0.1\")" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-20--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-20.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
###
add_test(NAME udp-21--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, id=1,  payload = *1472)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-21--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-21.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-22--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, id=1,  payload = *1473)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-22--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-22.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-23--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, id=1,  payload = *65507)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-23--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-23.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-24--nok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, id=1,  payload = *65508)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(udp-24--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME udp-25--ok COMMAND tcppump ${DEFAULT_PARAMS} "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=1, dport=2, payload = FE)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME udp-25--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/udp-25.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})

add_test(NAME tcp-1--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp()" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-1--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-2--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dmac=11:22:33:44:55:66)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-2--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-3--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-3--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-4--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-4--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-5--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-5--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-6--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-6--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-7--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-7--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-8--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0xffff, dport=0, seq=0, ack=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-8--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-08.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-9--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0x10000, dport=0, seq=0, ack=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-9--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-10--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0xffff, seq=0, ack=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-10--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-10.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-11--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0x10000, seq=0, ack=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-11--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-12--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0xffffffff, ack=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-12--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-12.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-13--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0x100000000, ack=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-13--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-14--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0xffffffff)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-14--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-14.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-15--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, win=1024)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-15--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-16--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, win=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-16--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-16.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-17--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, win=0xffff)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-17--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-17.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-18--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, win=0x10000)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-18--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-18--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, urgptr=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-18--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-19--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, urgptr=0xffff)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-19--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-19.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-20--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, urgptr=0x10000)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-20--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-21--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-21--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-22--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN=1)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-22--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-22.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-23--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-23--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-22.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-24--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN=2)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-24--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-25--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, SYN)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-25--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-25.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-26--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, RESET)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-26--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-26.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-27--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, PUSH)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-27--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-27.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-28--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, ACK)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-28--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-28.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-29--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, URGENT)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-29--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-29.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-30--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, ECN)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-30--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-30.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-31--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, CWR)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-31--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-31.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-32--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, NONCE)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-32--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-32.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-33--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN, SYN)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-33--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-33.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-34--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN, SYN, RESET)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-34--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-34.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-35--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN, SYN, RESET, PUSH)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-35--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-35.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-36--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN, SYN, RESET, PUSH, ACK)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-36--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-36.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-37--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN, SYN, RESET, PUSH, ACK, URGENT)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-37--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-37.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-38--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN, SYN, RESET, PUSH, ACK, URGENT, ECN)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-38--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-38.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-39--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN, SYN, RESET, PUSH, ACK, URGENT, ECN, CWR)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-39--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-39.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-40--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, FIN, SYN, RESET, PUSH, ACK, URGENT, ECN, CWR, NONCE)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-40--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-40.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-41--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, chksum=0x7fa3)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-41--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-42--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, chksum=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-42--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-42.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-43--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, chksum=0xffff)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-43--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-43.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-44--nok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, chksum=0x10000)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(tcp-44--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME tcp-45--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0, seq=0, ack=0, payload=*)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-45--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-45.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-46--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp-syn(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-46--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-25.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-47--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp-reset(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-47--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-26.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-48--ok COMMAND tcppump ${DEFAULT_PARAMS} "tcp-syn(sip=1.2.3.4, dip=10.20.30.40, smac=10:11:11:11:11:11, dmac=10:22:33:44:55:66, sport=0, dport=2)" "tcp-syn-ack(dip=1.2.3.4, sip=10.20.30.40, dmac=10:11:11:11:11:11, smac=10:22:33:44:55:66, dport=0, sport=2)" "tcp-syn-ack2(sip=1.2.3.4, dip=10.20.30.40, smac=10:11:11:11:11:11, dmac=10:22:33:44:55:66, sport=0, dport=2)" "tcp-fin(sip=1.2.3.4, dip=10.20.30.40, smac=10:11:11:11:11:11, dmac=10:22:33:44:55:66, sport=0, dport=2)" "tcp-fin-ack(dip=1.2.3.4, sip=10.20.30.40, dmac=10:11:11:11:11:11, smac=10:22:33:44:55:66, dport=0, sport=2)" "tcp-fin-ack2(sip=1.2.3.4, dip=10.20.30.40, smac=10:11:11:11:11:11, dmac=10:22:33:44:55:66, sport=0, dport=2)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME tcp-48--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/tcp-48.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})



add_test(NAME vrrp-1--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp()" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp-1--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp-2--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vrip=1.2.3.500)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp-2--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp-3--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp-3--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp-4--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vrid=0, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp-4--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp-5--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vrid=256, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp-5--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp-6--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-6--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-06.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-7--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vrid=1, vrip=1.2.3.5, vrip=1.2.3.6, vrip=1.2.3.7, vrip=1.2.3.8, vrip=1.2.3.9, vrip=1.2.3.10, vrip=1.2.3.11, vrip=1.2.3.12, vrip=1.2.3.13, vrip=1.2.3.14, vrip=1.2.3.15, vrip=1.2.3.16, vrip=1.2.3.17, vrip=1.2.3.18, vrip=1.2.3.19, vrip=1.2.3.20, vrip=1.2.3.21, vrip=1.2.3.22, vrip=1.2.3.23, vrip=1.2.3.24, vrip=1.2.3.25, vrip=1.2.3.26, vrip=1.2.3.27, vrip=1.2.3.28, vrip=1.2.3.29, vrip=1.2.3.30, vrip=1.2.3.31, vrip=1.2.3.32, vrip=1.2.3.33, vrip=1.2.3.34, vrip=1.2.3.35, vrip=1.2.3.36, vrip=1.2.3.37, vrip=1.2.3.38, vrip=1.2.3.39, vrip=1.2.3.40, vrip=1.2.3.41, vrip=1.2.3.42, vrip=1.2.3.43, vrip=1.2.3.44, vrip=1.2.3.45, vrip=1.2.3.46, vrip=1.2.3.47, vrip=1.2.3.48, vrip=1.2.3.49, vrip=1.2.3.50, vrip=1.2.3.51, vrip=1.2.3.52, vrip=1.2.3.53, vrip=1.2.3.54, vrip=1.2.3.55, vrip=1.2.3.56, vrip=1.2.3.57, vrip=1.2.3.58, vrip=1.2.3.59, vrip=1.2.3.60, vrip=1.2.3.61, vrip=1.2.3.62, vrip=1.2.3.63, vrip=1.2.3.64, vrip=1.2.3.65, vrip=1.2.3.66, vrip=1.2.3.67, vrip=1.2.3.68, vrip=1.2.3.69, vrip=1.2.3.70, vrip=1.2.3.71, vrip=1.2.3.72, vrip=1.2.3.73, vrip=1.2.3.74, vrip=1.2.3.75, vrip=1.2.3.76, vrip=1.2.3.77, vrip=1.2.3.78, vrip=1.2.3.79, vrip=1.2.3.80, vrip=1.2.3.81, vrip=1.2.3.82, vrip=1.2.3.83, vrip=1.2.3.84, vrip=1.2.3.85, vrip=1.2.3.86, vrip=1.2.3.87, vrip=1.2.3.88, vrip=1.2.3.89, vrip=1.2.3.90, vrip=1.2.3.91, vrip=1.2.3.92, vrip=1.2.3.93, vrip=1.2.3.94, vrip=1.2.3.95, vrip=1.2.3.96, vrip=1.2.3.97, vrip=1.2.3.98, vrip=1.2.3.99, vrip=1.2.3.100, vrip=1.2.3.101, vrip=1.2.3.102, vrip=1.2.3.103, vrip=1.2.3.104, vrip=1.2.3.105, vrip=1.2.3.106, vrip=1.2.3.107, vrip=1.2.3.108, vrip=1.2.3.109, vrip=1.2.3.110, vrip=1.2.3.111, vrip=1.2.3.112, vrip=1.2.3.113, vrip=1.2.3.114, vrip=1.2.3.115, vrip=1.2.3.116, vrip=1.2.3.117, vrip=1.2.3.118, vrip=1.2.3.119, vrip=1.2.3.120, vrip=1.2.3.121, vrip=1.2.3.122, vrip=1.2.3.123, vrip=1.2.3.124, vrip=1.2.3.125, vrip=1.2.3.126, vrip=1.2.3.127, vrip=1.2.3.128, vrip=1.2.3.129, vrip=1.2.3.130, vrip=1.2.3.131, vrip=1.2.3.132, vrip=1.2.3.133, vrip=1.2.3.134, vrip=1.2.3.135, vrip=1.2.3.136, vrip=1.2.3.137, vrip=1.2.3.138, vrip=1.2.3.139, vrip=1.2.3.140, vrip=1.2.3.141, vrip=1.2.3.142, vrip=1.2.3.143, vrip=1.2.3.144, vrip=1.2.3.145, vrip=1.2.3.146, vrip=1.2.3.147, vrip=1.2.3.148, vrip=1.2.3.149, vrip=1.2.3.150, vrip=1.2.3.151, vrip=1.2.3.152, vrip=1.2.3.153, vrip=1.2.3.154, vrip=1.2.3.155, vrip=1.2.3.156, vrip=1.2.3.157, vrip=1.2.3.158, vrip=1.2.3.159, vrip=1.2.3.160, vrip=1.2.3.161, vrip=1.2.3.162, vrip=1.2.3.163, vrip=1.2.3.164, vrip=1.2.3.165, vrip=1.2.3.166, vrip=1.2.3.167, vrip=1.2.3.168, vrip=1.2.3.169, vrip=1.2.3.170, vrip=1.2.3.171, vrip=1.2.3.172, vrip=1.2.3.173, vrip=1.2.3.174, vrip=1.2.3.175, vrip=1.2.3.176, vrip=1.2.3.177, vrip=1.2.3.178, vrip=1.2.3.179, vrip=1.2.3.180, vrip=1.2.3.181, vrip=1.2.3.182, vrip=1.2.3.183, vrip=1.2.3.184, vrip=1.2.3.185, vrip=1.2.3.186, vrip=1.2.3.187, vrip=1.2.3.188, vrip=1.2.3.189, vrip=1.2.3.190, vrip=1.2.3.191, vrip=1.2.3.192, vrip=1.2.3.193, vrip=1.2.3.194, vrip=1.2.3.195, vrip=1.2.3.196, vrip=1.2.3.197, vrip=1.2.3.198, vrip=1.2.3.199, vrip=1.2.3.200, vrip=1.2.3.201, vrip=1.2.3.202, vrip=1.2.3.203, vrip=1.2.3.204, vrip=1.2.3.205, vrip=1.2.3.206, vrip=1.2.3.207, vrip=1.2.3.208, vrip=1.2.3.209, vrip=1.2.3.210, vrip=1.2.3.211, vrip=1.2.3.212, vrip=1.2.3.213, vrip=1.2.3.214, vrip=1.2.3.215, vrip=1.2.3.216, vrip=1.2.3.217, vrip=1.2.3.218, vrip=1.2.3.219, vrip=1.2.3.220, vrip=1.2.3.221, vrip=1.2.3.222, vrip=1.2.3.223, vrip=1.2.3.224, vrip=1.2.3.225, vrip=1.2.3.226, vrip=1.2.3.227, vrip=1.2.3.228, vrip=1.2.3.229, vrip=1.2.3.230, vrip=1.2.3.231, vrip=1.2.3.232, vrip=1.2.3.233, vrip=1.2.3.234, vrip=1.2.3.235, vrip=1.2.3.236, vrip=1.2.3.237, vrip=1.2.3.238, vrip=1.2.3.239, vrip=1.2.3.240, vrip=1.2.3.241, vrip=1.2.3.242, vrip=1.2.3.243, vrip=1.2.3.244, vrip=1.2.3.245, vrip=1.2.3.246, vrip=1.2.3.247, vrip=1.2.3.248, vrip=1.2.3.249, vrip=1.2.3.250, vrip=1.2.3.251, vrip=1.2.3.252, vrip=1.2.3.253, vrip=1.2.3.254, vrip=1.2.4.1, vrip=1.2.4.2, vrip=1.2.4.3, vrip=1.2.4.4, vrip=1.2.4.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-7--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-8--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vrprio=100, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-8--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-06.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-9--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vrprio=0, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-9--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-09.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-10--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-10--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-10.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-11--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vrprio=256, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp-11--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp-12--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(aint=1, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-12--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-10.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-13--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(aint=255, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-13--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-13.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-14--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(aint=256, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp-14--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp-14--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(type=1, aint=1, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-14--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-10.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-15--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(type=0, aint=1, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-15--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-15.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-16--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(type=15, aint=1, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-16--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-16.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-17--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(type=16, aint=1, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp-17--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp-18--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(chksum=0, type=15, aint=1, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-18--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-18.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-19--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(chksum=0xffff, type=15, aint=1, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-19--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-19.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-20--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(chksum=0x10000, type=15, aint=1, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp-20--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp-21--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(sip=11.22.33.44, smac=90:91:92:93:94:95, aint=255, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-21--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-21.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-22--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(ecn=2, df=1, sip=11.22.33.44, smac=90:91:92:93:94:95, aint=255, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-22--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-22.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-23--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vid=42, vtype=2, dei=1, prio=4, vid=43, prio=5, dscp=42, ecn=2, df=1, sip=11.22.33.44, smac=90:91:92:93:94:95, aint=255, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-23--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-23.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-24--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(aint=0, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-24--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp-24.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp-25--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp(vrid=1, vrip=1.2.3.5, vrip=1.2.3.6, vrip=1.2.3.7, vrip=1.2.3.8, vrip=1.2.3.9, vrip=1.2.3.10, vrip=1.2.3.11, vrip=1.2.3.12, vrip=1.2.3.13, vrip=1.2.3.14, vrip=1.2.3.15, vrip=1.2.3.16, vrip=1.2.3.17, vrip=1.2.3.18, vrip=1.2.3.19, vrip=1.2.3.20, vrip=1.2.3.21, vrip=1.2.3.22, vrip=1.2.3.23, vrip=1.2.3.24, vrip=1.2.3.25, vrip=1.2.3.26, vrip=1.2.3.27, vrip=1.2.3.28, vrip=1.2.3.29, vrip=1.2.3.30, vrip=1.2.3.31, vrip=1.2.3.32, vrip=1.2.3.33, vrip=1.2.3.34, vrip=1.2.3.35, vrip=1.2.3.36, vrip=1.2.3.37, vrip=1.2.3.38, vrip=1.2.3.39, vrip=1.2.3.40, vrip=1.2.3.41, vrip=1.2.3.42, vrip=1.2.3.43, vrip=1.2.3.44, vrip=1.2.3.45, vrip=1.2.3.46, vrip=1.2.3.47, vrip=1.2.3.48, vrip=1.2.3.49, vrip=1.2.3.50, vrip=1.2.3.51, vrip=1.2.3.52, vrip=1.2.3.53, vrip=1.2.3.54, vrip=1.2.3.55, vrip=1.2.3.56, vrip=1.2.3.57, vrip=1.2.3.58, vrip=1.2.3.59, vrip=1.2.3.60, vrip=1.2.3.61, vrip=1.2.3.62, vrip=1.2.3.63, vrip=1.2.3.64, vrip=1.2.3.65, vrip=1.2.3.66, vrip=1.2.3.67, vrip=1.2.3.68, vrip=1.2.3.69, vrip=1.2.3.70, vrip=1.2.3.71, vrip=1.2.3.72, vrip=1.2.3.73, vrip=1.2.3.74, vrip=1.2.3.75, vrip=1.2.3.76, vrip=1.2.3.77, vrip=1.2.3.78, vrip=1.2.3.79, vrip=1.2.3.80, vrip=1.2.3.81, vrip=1.2.3.82, vrip=1.2.3.83, vrip=1.2.3.84, vrip=1.2.3.85, vrip=1.2.3.86, vrip=1.2.3.87, vrip=1.2.3.88, vrip=1.2.3.89, vrip=1.2.3.90, vrip=1.2.3.91, vrip=1.2.3.92, vrip=1.2.3.93, vrip=1.2.3.94, vrip=1.2.3.95, vrip=1.2.3.96, vrip=1.2.3.97, vrip=1.2.3.98, vrip=1.2.3.99, vrip=1.2.3.100, vrip=1.2.3.101, vrip=1.2.3.102, vrip=1.2.3.103, vrip=1.2.3.104, vrip=1.2.3.105, vrip=1.2.3.106, vrip=1.2.3.107, vrip=1.2.3.108, vrip=1.2.3.109, vrip=1.2.3.110, vrip=1.2.3.111, vrip=1.2.3.112, vrip=1.2.3.113, vrip=1.2.3.114, vrip=1.2.3.115, vrip=1.2.3.116, vrip=1.2.3.117, vrip=1.2.3.118, vrip=1.2.3.119, vrip=1.2.3.120, vrip=1.2.3.121, vrip=1.2.3.122, vrip=1.2.3.123, vrip=1.2.3.124, vrip=1.2.3.125, vrip=1.2.3.126, vrip=1.2.3.127, vrip=1.2.3.128, vrip=1.2.3.129, vrip=1.2.3.130, vrip=1.2.3.131, vrip=1.2.3.132, vrip=1.2.3.133, vrip=1.2.3.134, vrip=1.2.3.135, vrip=1.2.3.136, vrip=1.2.3.137, vrip=1.2.3.138, vrip=1.2.3.139, vrip=1.2.3.140, vrip=1.2.3.141, vrip=1.2.3.142, vrip=1.2.3.143, vrip=1.2.3.144, vrip=1.2.3.145, vrip=1.2.3.146, vrip=1.2.3.147, vrip=1.2.3.148, vrip=1.2.3.149, vrip=1.2.3.150, vrip=1.2.3.151, vrip=1.2.3.152, vrip=1.2.3.153, vrip=1.2.3.154, vrip=1.2.3.155, vrip=1.2.3.156, vrip=1.2.3.157, vrip=1.2.3.158, vrip=1.2.3.159, vrip=1.2.3.160, vrip=1.2.3.161, vrip=1.2.3.162, vrip=1.2.3.163, vrip=1.2.3.164, vrip=1.2.3.165, vrip=1.2.3.166, vrip=1.2.3.167, vrip=1.2.3.168, vrip=1.2.3.169, vrip=1.2.3.170, vrip=1.2.3.171, vrip=1.2.3.172, vrip=1.2.3.173, vrip=1.2.3.174, vrip=1.2.3.175, vrip=1.2.3.176, vrip=1.2.3.177, vrip=1.2.3.178, vrip=1.2.3.179, vrip=1.2.3.180, vrip=1.2.3.181, vrip=1.2.3.182, vrip=1.2.3.183, vrip=1.2.3.184, vrip=1.2.3.185, vrip=1.2.3.186, vrip=1.2.3.187, vrip=1.2.3.188, vrip=1.2.3.189, vrip=1.2.3.190, vrip=1.2.3.191, vrip=1.2.3.192, vrip=1.2.3.193, vrip=1.2.3.194, vrip=1.2.3.195, vrip=1.2.3.196, vrip=1.2.3.197, vrip=1.2.3.198, vrip=1.2.3.199, vrip=1.2.3.200, vrip=1.2.3.201, vrip=1.2.3.202, vrip=1.2.3.203, vrip=1.2.3.204, vrip=1.2.3.205, vrip=1.2.3.206, vrip=1.2.3.207, vrip=1.2.3.208, vrip=1.2.3.209, vrip=1.2.3.210, vrip=1.2.3.211, vrip=1.2.3.212, vrip=1.2.3.213, vrip=1.2.3.214, vrip=1.2.3.215, vrip=1.2.3.216, vrip=1.2.3.217, vrip=1.2.3.218, vrip=1.2.3.219, vrip=1.2.3.220, vrip=1.2.3.221, vrip=1.2.3.222, vrip=1.2.3.223, vrip=1.2.3.224, vrip=1.2.3.225, vrip=1.2.3.226, vrip=1.2.3.227, vrip=1.2.3.228, vrip=1.2.3.229, vrip=1.2.3.230, vrip=1.2.3.231, vrip=1.2.3.232, vrip=1.2.3.233, vrip=1.2.3.234, vrip=1.2.3.235, vrip=1.2.3.236, vrip=1.2.3.237, vrip=1.2.3.238, vrip=1.2.3.239, vrip=1.2.3.240, vrip=1.2.3.241, vrip=1.2.3.242, vrip=1.2.3.243, vrip=1.2.3.244, vrip=1.2.3.245, vrip=1.2.3.246, vrip=1.2.3.247, vrip=1.2.3.248, vrip=1.2.3.249, vrip=1.2.3.250, vrip=1.2.3.251, vrip=1.2.3.252, vrip=1.2.3.253, vrip=1.2.3.254, vrip=1.2.4.1, vrip=1.2.4.2, vrip=1.2.4.3, vrip=1.2.4.4, vrip=1.2.4.5, vrip=1.2.4.6)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp-25--nok PROPERTIES WILL_FAIL TRUE)

add_test(NAME vrrp3-1--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3()" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp3-1--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp3-2--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vrip=1.2.3.500)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp3-2--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp3-3--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp3-3--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp3-4--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vrid=0, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp3-4--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp3-5--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vrid=256, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp3-5--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp3-6--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-6--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-06.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-7--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vrid=1, vrip=1.2.3.5, vrip=1.2.3.6, vrip=1.2.3.7, vrip=1.2.3.8, vrip=1.2.3.9, vrip=1.2.3.10, vrip=1.2.3.11, vrip=1.2.3.12, vrip=1.2.3.13, vrip=1.2.3.14, vrip=1.2.3.15, vrip=1.2.3.16, vrip=1.2.3.17, vrip=1.2.3.18, vrip=1.2.3.19, vrip=1.2.3.20, vrip=1.2.3.21, vrip=1.2.3.22, vrip=1.2.3.23, vrip=1.2.3.24, vrip=1.2.3.25, vrip=1.2.3.26, vrip=1.2.3.27, vrip=1.2.3.28, vrip=1.2.3.29, vrip=1.2.3.30, vrip=1.2.3.31, vrip=1.2.3.32, vrip=1.2.3.33, vrip=1.2.3.34, vrip=1.2.3.35, vrip=1.2.3.36, vrip=1.2.3.37, vrip=1.2.3.38, vrip=1.2.3.39, vrip=1.2.3.40, vrip=1.2.3.41, vrip=1.2.3.42, vrip=1.2.3.43, vrip=1.2.3.44, vrip=1.2.3.45, vrip=1.2.3.46, vrip=1.2.3.47, vrip=1.2.3.48, vrip=1.2.3.49, vrip=1.2.3.50, vrip=1.2.3.51, vrip=1.2.3.52, vrip=1.2.3.53, vrip=1.2.3.54, vrip=1.2.3.55, vrip=1.2.3.56, vrip=1.2.3.57, vrip=1.2.3.58, vrip=1.2.3.59, vrip=1.2.3.60, vrip=1.2.3.61, vrip=1.2.3.62, vrip=1.2.3.63, vrip=1.2.3.64, vrip=1.2.3.65, vrip=1.2.3.66, vrip=1.2.3.67, vrip=1.2.3.68, vrip=1.2.3.69, vrip=1.2.3.70, vrip=1.2.3.71, vrip=1.2.3.72, vrip=1.2.3.73, vrip=1.2.3.74, vrip=1.2.3.75, vrip=1.2.3.76, vrip=1.2.3.77, vrip=1.2.3.78, vrip=1.2.3.79, vrip=1.2.3.80, vrip=1.2.3.81, vrip=1.2.3.82, vrip=1.2.3.83, vrip=1.2.3.84, vrip=1.2.3.85, vrip=1.2.3.86, vrip=1.2.3.87, vrip=1.2.3.88, vrip=1.2.3.89, vrip=1.2.3.90, vrip=1.2.3.91, vrip=1.2.3.92, vrip=1.2.3.93, vrip=1.2.3.94, vrip=1.2.3.95, vrip=1.2.3.96, vrip=1.2.3.97, vrip=1.2.3.98, vrip=1.2.3.99, vrip=1.2.3.100, vrip=1.2.3.101, vrip=1.2.3.102, vrip=1.2.3.103, vrip=1.2.3.104, vrip=1.2.3.105, vrip=1.2.3.106, vrip=1.2.3.107, vrip=1.2.3.108, vrip=1.2.3.109, vrip=1.2.3.110, vrip=1.2.3.111, vrip=1.2.3.112, vrip=1.2.3.113, vrip=1.2.3.114, vrip=1.2.3.115, vrip=1.2.3.116, vrip=1.2.3.117, vrip=1.2.3.118, vrip=1.2.3.119, vrip=1.2.3.120, vrip=1.2.3.121, vrip=1.2.3.122, vrip=1.2.3.123, vrip=1.2.3.124, vrip=1.2.3.125, vrip=1.2.3.126, vrip=1.2.3.127, vrip=1.2.3.128, vrip=1.2.3.129, vrip=1.2.3.130, vrip=1.2.3.131, vrip=1.2.3.132, vrip=1.2.3.133, vrip=1.2.3.134, vrip=1.2.3.135, vrip=1.2.3.136, vrip=1.2.3.137, vrip=1.2.3.138, vrip=1.2.3.139, vrip=1.2.3.140, vrip=1.2.3.141, vrip=1.2.3.142, vrip=1.2.3.143, vrip=1.2.3.144, vrip=1.2.3.145, vrip=1.2.3.146, vrip=1.2.3.147, vrip=1.2.3.148, vrip=1.2.3.149, vrip=1.2.3.150, vrip=1.2.3.151, vrip=1.2.3.152, vrip=1.2.3.153, vrip=1.2.3.154, vrip=1.2.3.155, vrip=1.2.3.156, vrip=1.2.3.157, vrip=1.2.3.158, vrip=1.2.3.159, vrip=1.2.3.160, vrip=1.2.3.161, vrip=1.2.3.162, vrip=1.2.3.163, vrip=1.2.3.164, vrip=1.2.3.165, vrip=1.2.3.166, vrip=1.2.3.167, vrip=1.2.3.168, vrip=1.2.3.169, vrip=1.2.3.170, vrip=1.2.3.171, vrip=1.2.3.172, vrip=1.2.3.173, vrip=1.2.3.174, vrip=1.2.3.175, vrip=1.2.3.176, vrip=1.2.3.177, vrip=1.2.3.178, vrip=1.2.3.179, vrip=1.2.3.180, vrip=1.2.3.181, vrip=1.2.3.182, vrip=1.2.3.183, vrip=1.2.3.184, vrip=1.2.3.185, vrip=1.2.3.186, vrip=1.2.3.187, vrip=1.2.3.188, vrip=1.2.3.189, vrip=1.2.3.190, vrip=1.2.3.191, vrip=1.2.3.192, vrip=1.2.3.193, vrip=1.2.3.194, vrip=1.2.3.195, vrip=1.2.3.196, vrip=1.2.3.197, vrip=1.2.3.198, vrip=1.2.3.199, vrip=1.2.3.200, vrip=1.2.3.201, vrip=1.2.3.202, vrip=1.2.3.203, vrip=1.2.3.204, vrip=1.2.3.205, vrip=1.2.3.206, vrip=1.2.3.207, vrip=1.2.3.208, vrip=1.2.3.209, vrip=1.2.3.210, vrip=1.2.3.211, vrip=1.2.3.212, vrip=1.2.3.213, vrip=1.2.3.214, vrip=1.2.3.215, vrip=1.2.3.216, vrip=1.2.3.217, vrip=1.2.3.218, vrip=1.2.3.219, vrip=1.2.3.220, vrip=1.2.3.221, vrip=1.2.3.222, vrip=1.2.3.223, vrip=1.2.3.224, vrip=1.2.3.225, vrip=1.2.3.226, vrip=1.2.3.227, vrip=1.2.3.228, vrip=1.2.3.229, vrip=1.2.3.230, vrip=1.2.3.231, vrip=1.2.3.232, vrip=1.2.3.233, vrip=1.2.3.234, vrip=1.2.3.235, vrip=1.2.3.236, vrip=1.2.3.237, vrip=1.2.3.238, vrip=1.2.3.239, vrip=1.2.3.240, vrip=1.2.3.241, vrip=1.2.3.242, vrip=1.2.3.243, vrip=1.2.3.244, vrip=1.2.3.245, vrip=1.2.3.246, vrip=1.2.3.247, vrip=1.2.3.248, vrip=1.2.3.249, vrip=1.2.3.250, vrip=1.2.3.251, vrip=1.2.3.252, vrip=1.2.3.253, vrip=1.2.3.254, vrip=1.2.4.1, vrip=1.2.4.2, vrip=1.2.4.3, vrip=1.2.4.4, vrip=1.2.4.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-7--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-8--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vrprio=100, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-8--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-06.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-9--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vrprio=0, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-9--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-09.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-10--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-10--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-10.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-11--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vrprio=256, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp3-11--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp3-12--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(aint=100, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-12--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-10.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-13--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(aint=4095, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-13--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-13.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-14--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(aint=4096, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp3-14--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp3-14--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(type=1, aint=100, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-14--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-10.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-15--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(type=0, aint=100, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-15--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-15.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-16--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(type=15, aint=100, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-16--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-16.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-17--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(type=16, aint=1, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp3-17--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp3-18--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(chksum=0, type=15, aint=100, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-18--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-18.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-19--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(chksum=0xffff, type=15, aint=100, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-19--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-19.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-20--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(chksum=0x10000, type=15, aint=100, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp3-20--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME vrrp3-21--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(sip=11.22.33.44, smac=90:91:92:93:94:95, aint=4095, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-21--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-21.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-22--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(ecn=2, df=1, sip=11.22.33.44, smac=90:91:92:93:94:95, aint=4095, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-22--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-22.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-23--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vid=42, vtype=2, dei=1, prio=4, vid=43, prio=5, dscp=42, ecn=2, df=1, sip=11.22.33.44, smac=90:91:92:93:94:95, aint=4095, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-23--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-23.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-24--ok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(aint=0, vrprio=255, vrid=1, vrip=1.2.3.5)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-24--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/vrrp3-24.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME vrrp3-25--nok COMMAND tcppump ${DEFAULT_PARAMS} "vrrp3(vrid=1, vrip=1.2.3.5, vrip=1.2.3.6, vrip=1.2.3.7, vrip=1.2.3.8, vrip=1.2.3.9, vrip=1.2.3.10, vrip=1.2.3.11, vrip=1.2.3.12, vrip=1.2.3.13, vrip=1.2.3.14, vrip=1.2.3.15, vrip=1.2.3.16, vrip=1.2.3.17, vrip=1.2.3.18, vrip=1.2.3.19, vrip=1.2.3.20, vrip=1.2.3.21, vrip=1.2.3.22, vrip=1.2.3.23, vrip=1.2.3.24, vrip=1.2.3.25, vrip=1.2.3.26, vrip=1.2.3.27, vrip=1.2.3.28, vrip=1.2.3.29, vrip=1.2.3.30, vrip=1.2.3.31, vrip=1.2.3.32, vrip=1.2.3.33, vrip=1.2.3.34, vrip=1.2.3.35, vrip=1.2.3.36, vrip=1.2.3.37, vrip=1.2.3.38, vrip=1.2.3.39, vrip=1.2.3.40, vrip=1.2.3.41, vrip=1.2.3.42, vrip=1.2.3.43, vrip=1.2.3.44, vrip=1.2.3.45, vrip=1.2.3.46, vrip=1.2.3.47, vrip=1.2.3.48, vrip=1.2.3.49, vrip=1.2.3.50, vrip=1.2.3.51, vrip=1.2.3.52, vrip=1.2.3.53, vrip=1.2.3.54, vrip=1.2.3.55, vrip=1.2.3.56, vrip=1.2.3.57, vrip=1.2.3.58, vrip=1.2.3.59, vrip=1.2.3.60, vrip=1.2.3.61, vrip=1.2.3.62, vrip=1.2.3.63, vrip=1.2.3.64, vrip=1.2.3.65, vrip=1.2.3.66, vrip=1.2.3.67, vrip=1.2.3.68, vrip=1.2.3.69, vrip=1.2.3.70, vrip=1.2.3.71, vrip=1.2.3.72, vrip=1.2.3.73, vrip=1.2.3.74, vrip=1.2.3.75, vrip=1.2.3.76, vrip=1.2.3.77, vrip=1.2.3.78, vrip=1.2.3.79, vrip=1.2.3.80, vrip=1.2.3.81, vrip=1.2.3.82, vrip=1.2.3.83, vrip=1.2.3.84, vrip=1.2.3.85, vrip=1.2.3.86, vrip=1.2.3.87, vrip=1.2.3.88, vrip=1.2.3.89, vrip=1.2.3.90, vrip=1.2.3.91, vrip=1.2.3.92, vrip=1.2.3.93, vrip=1.2.3.94, vrip=1.2.3.95, vrip=1.2.3.96, vrip=1.2.3.97, vrip=1.2.3.98, vrip=1.2.3.99, vrip=1.2.3.100, vrip=1.2.3.101, vrip=1.2.3.102, vrip=1.2.3.103, vrip=1.2.3.104, vrip=1.2.3.105, vrip=1.2.3.106, vrip=1.2.3.107, vrip=1.2.3.108, vrip=1.2.3.109, vrip=1.2.3.110, vrip=1.2.3.111, vrip=1.2.3.112, vrip=1.2.3.113, vrip=1.2.3.114, vrip=1.2.3.115, vrip=1.2.3.116, vrip=1.2.3.117, vrip=1.2.3.118, vrip=1.2.3.119, vrip=1.2.3.120, vrip=1.2.3.121, vrip=1.2.3.122, vrip=1.2.3.123, vrip=1.2.3.124, vrip=1.2.3.125, vrip=1.2.3.126, vrip=1.2.3.127, vrip=1.2.3.128, vrip=1.2.3.129, vrip=1.2.3.130, vrip=1.2.3.131, vrip=1.2.3.132, vrip=1.2.3.133, vrip=1.2.3.134, vrip=1.2.3.135, vrip=1.2.3.136, vrip=1.2.3.137, vrip=1.2.3.138, vrip=1.2.3.139, vrip=1.2.3.140, vrip=1.2.3.141, vrip=1.2.3.142, vrip=1.2.3.143, vrip=1.2.3.144, vrip=1.2.3.145, vrip=1.2.3.146, vrip=1.2.3.147, vrip=1.2.3.148, vrip=1.2.3.149, vrip=1.2.3.150, vrip=1.2.3.151, vrip=1.2.3.152, vrip=1.2.3.153, vrip=1.2.3.154, vrip=1.2.3.155, vrip=1.2.3.156, vrip=1.2.3.157, vrip=1.2.3.158, vrip=1.2.3.159, vrip=1.2.3.160, vrip=1.2.3.161, vrip=1.2.3.162, vrip=1.2.3.163, vrip=1.2.3.164, vrip=1.2.3.165, vrip=1.2.3.166, vrip=1.2.3.167, vrip=1.2.3.168, vrip=1.2.3.169, vrip=1.2.3.170, vrip=1.2.3.171, vrip=1.2.3.172, vrip=1.2.3.173, vrip=1.2.3.174, vrip=1.2.3.175, vrip=1.2.3.176, vrip=1.2.3.177, vrip=1.2.3.178, vrip=1.2.3.179, vrip=1.2.3.180, vrip=1.2.3.181, vrip=1.2.3.182, vrip=1.2.3.183, vrip=1.2.3.184, vrip=1.2.3.185, vrip=1.2.3.186, vrip=1.2.3.187, vrip=1.2.3.188, vrip=1.2.3.189, vrip=1.2.3.190, vrip=1.2.3.191, vrip=1.2.3.192, vrip=1.2.3.193, vrip=1.2.3.194, vrip=1.2.3.195, vrip=1.2.3.196, vrip=1.2.3.197, vrip=1.2.3.198, vrip=1.2.3.199, vrip=1.2.3.200, vrip=1.2.3.201, vrip=1.2.3.202, vrip=1.2.3.203, vrip=1.2.3.204, vrip=1.2.3.205, vrip=1.2.3.206, vrip=1.2.3.207, vrip=1.2.3.208, vrip=1.2.3.209, vrip=1.2.3.210, vrip=1.2.3.211, vrip=1.2.3.212, vrip=1.2.3.213, vrip=1.2.3.214, vrip=1.2.3.215, vrip=1.2.3.216, vrip=1.2.3.217, vrip=1.2.3.218, vrip=1.2.3.219, vrip=1.2.3.220, vrip=1.2.3.221, vrip=1.2.3.222, vrip=1.2.3.223, vrip=1.2.3.224, vrip=1.2.3.225, vrip=1.2.3.226, vrip=1.2.3.227, vrip=1.2.3.228, vrip=1.2.3.229, vrip=1.2.3.230, vrip=1.2.3.231, vrip=1.2.3.232, vrip=1.2.3.233, vrip=1.2.3.234, vrip=1.2.3.235, vrip=1.2.3.236, vrip=1.2.3.237, vrip=1.2.3.238, vrip=1.2.3.239, vrip=1.2.3.240, vrip=1.2.3.241, vrip=1.2.3.242, vrip=1.2.3.243, vrip=1.2.3.244, vrip=1.2.3.245, vrip=1.2.3.246, vrip=1.2.3.247, vrip=1.2.3.248, vrip=1.2.3.249, vrip=1.2.3.250, vrip=1.2.3.251, vrip=1.2.3.252, vrip=1.2.3.253, vrip=1.2.3.254, vrip=1.2.4.1, vrip=1.2.4.2, vrip=1.2.4.3, vrip=1.2.4.4, vrip=1.2.4.5, vrip=1.2.4.6)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(vrrp3-25--nok PROPERTIES WILL_FAIL TRUE)

add_test(NAME stp-1--ok COMMAND tcppump ${DEFAULT_PARAMS} "stp()" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME stp-1--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/stp-01.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})

add_test(NAME rstp-1--ok COMMAND tcppump ${DEFAULT_PARAMS} "rstp()" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME rstp-1--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/rstp-01.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})

add_test(NAME igmp-1--nok COMMAND tcppump ${DEFAULT_PARAMS} "igmp()" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(igmp-1--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME igmp-2--nok COMMAND tcppump ${DEFAULT_PARAMS} "igmp(dmac=11:22:33:44:55:66)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(igmp-2--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME igmp-3--nok COMMAND tcppump ${DEFAULT_PARAMS} "igmp(dmac=11:22:33:44:55:66, dip=10.20.30.40, group=224.0.0.1)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(igmp-3--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME igmp-4--ok COMMAND tcppump ${DEFAULT_PARAMS} "igmp(dmac=11:22:33:44:55:66, dip=10.20.30.40, group=224.0.0.1, type=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME igmp-4--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/igmp-04.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME igmp-5--ok COMMAND tcppump ${DEFAULT_PARAMS} "igmp(dmac=11:22:33:44:55:66, dip=10.20.30.40, group=224.0.0.1, type=255)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME igmp-5--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/igmp-06.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME igmp-6--nok COMMAND tcppump ${DEFAULT_PARAMS} "igmp(dmac=11:22:33:44:55:66, dip=10.20.30.40, group=224.0.0.1, type=256)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(igmp-6--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME igmp-7--ok COMMAND tcppump ${DEFAULT_PARAMS} "igmp(dip=225.0.0.1, group=224.0.0.1, type=0x11)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME igmp-7--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/igmp-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME igmp-8--ok COMMAND tcppump ${DEFAULT_PARAMS} "igmp(dip=225.0.0.1, group=224.0.0.1, type=0x11, time=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME igmp-8--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/igmp-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME igmp-9--ok COMMAND tcppump ${DEFAULT_PARAMS} "igmp(dip=225.0.0.1, group=224.0.0.1, type=0x11, time=255)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME igmp-9--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/igmp-09.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME igmp-10--nok COMMAND tcppump ${DEFAULT_PARAMS} "igmp(dip=225.0.0.1, group=224.0.0.1, type=0x11, time=256)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(igmp-10--nok PROPERTIES WILL_FAIL TRUE)

add_test(NAME script-01--ok COMMAND tcppump ${DEFAULT_PARAMS} -vvv -s ${TEST_FILE_PREFIX}/all.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(script-01--ok PROPERTIES PASS_REGULAR_EXPRESSION "Will send 243 packets.*Successfully wrote 243 packets")
add_test(NAME script-01--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/all.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})

### AFL findings
add_test(NAME syntax-error-1--nok COMMAND tcppump ${DEFAULT_PARAMS} -vvv -s ${TEST_FILE_PREFIX}/syntax-error-01.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(syntax-error-1--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME syntax-error-2--nok COMMAND tcppump ${DEFAULT_PARAMS} -vvv -s ${TEST_FILE_PREFIX}/syntax-error-02.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(syntax-error-2--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME syntax-error-3--nok COMMAND tcppump ${DEFAULT_PARAMS} -vvv -s ${TEST_FILE_PREFIX}/syntax-error-03.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(syntax-error-3--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME syntax-error-4--nok COMMAND tcppump ${DEFAULT_PARAMS} -vvv -s ${TEST_FILE_PREFIX}/syntax-error-04.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(syntax-error-4--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME syntax-error-5--nok COMMAND tcppump ${DEFAULT_PARAMS} -vvv -s ${TEST_FILE_PREFIX}/syntax-error-05.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(syntax-error-5--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME syntax-error-6--nok COMMAND tcppump ${DEFAULT_PARAMS} -vvv -s ${TEST_FILE_PREFIX}/syntax-error-06.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(syntax-error-6--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME syntax-error-7--nok COMMAND tcppump ${DEFAULT_PARAMS} -vvv -s ${TEST_FILE_PREFIX}/syntax-error-07.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(syntax-error-7--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME syntax-error-8--nok COMMAND tcppump ${DEFAULT_PARAMS} -vvv -s ${TEST_FILE_PREFIX}/syntax-error-08.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(syntax-error-8--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME syntax-error-9--nok COMMAND tcppump ${DEFAULT_PARAMS} -vvv -s ${TEST_FILE_PREFIX}/syntax-error-09.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(syntax-error-9--nok PROPERTIES WILL_FAIL TRUE)

add_test(NAME delay-1--ok COMMAND tcppump ${DEFAULT_PARAMS} -l3 "arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-1--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-01.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-2--ok COMMAND tcppump ${DEFAULT_PARAMS} -d2 -l3 "arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-2--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-02.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-3--ok COMMAND tcppump ${DEFAULT_PARAMS} -tm -d2 -l3 "arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-3--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-02.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-4--ok COMMAND tcppump ${DEFAULT_PARAMS} -tu -d2 -l3 "arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-4--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-04.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-5--ok COMMAND tcppump ${DEFAULT_PARAMS} -tc -d2 -l3 "arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-5--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-05.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-6--ok COMMAND tcppump ${DEFAULT_PARAMS} -ts -d2 -l3 "arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-6--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-06.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-7--ok COMMAND tcppump ${DEFAULT_PARAMS} -l3 -s ${TEST_FILE_PREFIX}/delay-07.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-7--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-01.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-8--ok COMMAND tcppump ${DEFAULT_PARAMS} -d2 -l3 -s ${TEST_FILE_PREFIX}/delay-07.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-8--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-02.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-9--ok COMMAND tcppump ${DEFAULT_PARAMS} -tm -d2 -l3 -s ${TEST_FILE_PREFIX}/delay-07.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-9--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-02.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-10--ok COMMAND tcppump ${DEFAULT_PARAMS} -tu -d2 -l3 -s ${TEST_FILE_PREFIX}/delay-07.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-10--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-04.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-11--ok COMMAND tcppump ${DEFAULT_PARAMS} -tc -d2 -l3 -s ${TEST_FILE_PREFIX}/delay-07.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-11--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-05.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-12--ok COMMAND tcppump ${DEFAULT_PARAMS} -ts -d2 -l3 -s ${TEST_FILE_PREFIX}/delay-07.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-12--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-06.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-13--ok COMMAND tcppump ${DEFAULT_PARAMS} -s ${TEST_FILE_PREFIX}/delay-13.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-13--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-13.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-14--ok COMMAND tcppump ${DEFAULT_PARAMS} -tu -s ${TEST_FILE_PREFIX}/delay-13.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-14--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-14.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-15--ok COMMAND tcppump ${DEFAULT_PARAMS} -tu -d50 -s ${TEST_FILE_PREFIX}/delay-13.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-15--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-15.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-16--ok COMMAND tcppump ${DEFAULT_PARAMS} -tu -d92 -s ${TEST_FILE_PREFIX}/delay-13.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-16--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-16.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
# TODO this leads to BUG because error handling of "unsorted" timestamps not yet implemented
#add_test(NAME delay-17--nok COMMAND tcppump ${DEFAULT_PARAMS} -tu -d93 -s ${TEST_FILE_PREFIX}/delay-13.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
#set_tests_properties(delay-17--nok PROPERTIES WILL_FAIL TRUE)
add_test(NAME delay-18--ok COMMAND tcppump ${DEFAULT_PARAMS} -s ${TEST_FILE_PREFIX}/delay-18.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-18--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-18.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-19--ok COMMAND tcppump ${DEFAULT_PARAMS} -l2 -s ${TEST_FILE_PREFIX}/delay-18.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-19--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-19.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-20--ok COMMAND tcppump ${DEFAULT_PARAMS} -d50 -l2 -s ${TEST_FILE_PREFIX}/delay-18.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-20--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-20.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-21--ok COMMAND tcppump ${DEFAULT_PARAMS} -d50 -s ${TEST_FILE_PREFIX}/delay-18.pump ${TEST_FILE_PREFIX}/delay-18.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-21--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-20.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-22--ok COMMAND tcppump ${DEFAULT_PARAMS} -d50 -l2 -s ${TEST_FILE_PREFIX}/delay-18.pump ${TEST_FILE_PREFIX}/delay-18.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-22--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-22.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-23--ok COMMAND tcppump ${DEFAULT_PARAMS} -l2 -s ${TEST_FILE_PREFIX}/delay-13.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-23--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-23.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-24--ok COMMAND tcppump ${DEFAULT_PARAMS} -d1 -l2 -s ${TEST_FILE_PREFIX}/delay-24.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-24--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-24.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-25-ok COMMAND tcppump ${DEFAULT_PARAMS} "1: arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-25--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-25.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-26-ok COMMAND tcppump ${DEFAULT_PARAMS} -d2 "1: arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-26--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-25.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-27-ok COMMAND tcppump ${DEFAULT_PARAMS} -tm "1: arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-27--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-25.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-28-ok COMMAND tcppump ${DEFAULT_PARAMS} -tc "1: arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-28--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-28.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-29-ok COMMAND tcppump ${DEFAULT_PARAMS} -l3 "2: arp(dip=10.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-29--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-29.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-30-ok COMMAND tcppump ${DEFAULT_PARAMS} -l3 "2: arp(dip=10.20.30.40)" "3: arp(dip=20.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-30--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-30.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-31-ok COMMAND tcppump ${DEFAULT_PARAMS} -l3 "2: arp(dip=10.20.30.40)" "arp(dip=20.20.30.40)" "+5: arp(dip=30.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-31--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-31.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-32-ok COMMAND tcppump ${DEFAULT_PARAMS} -d50 -l3 "2: arp(dip=10.20.30.40)" "arp(dip=20.20.30.40)" "+5: arp(dip=30.20.30.40)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME delay-32--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-32.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})

add_test(NAME overwrite-dmac-1--ok COMMAND tcppump ${DEFAULT_PARAMS} --overwrite-dmac=12:34:56:78:90:91 "eth(dmac=11:22:33:44:55:66, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME overwrite-dmac-1--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/overwrite-dmac-01.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME overwrite-dmac-2--ok COMMAND tcppump ${DEFAULT_PARAMS} --overwrite-dmac=12:34:56:78:90:91 "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME overwrite-dmac-2--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/overwrite-dmac-02.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME overwrite-dmac-3--ok COMMAND tcppump ${DEFAULT_PARAMS} --rand-dmac --overwrite-dmac=12:34:56:78:90:91 "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME overwrite-dmac-3--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/overwrite-dmac-02.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
# --rand-dmac overrules --overwrite-dmac --> diff MUST fail
set_tests_properties(overwrite-dmac-3--diff PROPERTIES WILL_FAIL TRUE)

add_test(NAME random-mac-1--ok COMMAND tcppump ${DEFAULT_PARAMS} --rand-dmac "eth(dmac=11:22:33:44:55:66, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-1--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/random-mac-01.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-2--ok COMMAND tcppump ${DEFAULT_PARAMS} --rand-smac "eth(dmac=11:22:33:44:55:66, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-2--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/random-mac-02.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-3--ok COMMAND tcppump ${DEFAULT_PARAMS} --rand-dmac --rand-smac "eth(dmac=11:22:33:44:55:66, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-3--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/random-mac-03.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-4--ok COMMAND tcppump ${DEFAULT_PARAMS} --rand-dmac --rand-smac "eth(dmac=11:22:33:44:55:66, payload = 0123456789abcdef0123456789abcdef)" "eth(dmac=11:22:33:44:55:66, payload = 0123456789abcdef0123456789abcdef)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-4--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/random-mac-04.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-5--ok COMMAND tcppump ${DEFAULT_PARAMS} --rand-dmac "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-5--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/random-mac-05.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-6--ok COMMAND tcppump ${DEFAULT_PARAMS} --rand-smac "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-6--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/random-mac-06.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-7--ok COMMAND tcppump ${DEFAULT_PARAMS} --rand-dmac --rand-smac "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-7--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/random-mac-07.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-8--ok COMMAND tcppump ${DEFAULT_PARAMS} --rand-dmac --rand-smac "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" "udp(dip=10.20.30.40, dmac=11:22:33:44:55:66, sport=0, dport=0)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME random-mac-8--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/random-mac-08.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})


add_test(NAME online-1--ok COMMAND tcppump -i ${OUT_IFC} -vvvv "arp(dip=1.2.3.4)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(online-1--ok PROPERTIES PASS_REGULAR_EXPRESSION "Successfully sent 1 packet.")
add_test(NAME online-2--ok COMMAND tcppump -i ${OUT_IFC} -l2 -vvvv "arp(dip=1.2.3.4)" WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(online-2--ok PROPERTIES PASS_REGULAR_EXPRESSION "Successfully sent 2 packet.")

add_test(NAME loop-01--ok COMMAND tcppump ${DEFAULT_PARAMS} -s ${TEST_FILE_PREFIX}/loop-01.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
# TODO failes because not yet implemented
#add_test(NAME loop-01--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/loop-01.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME loop-02--nok COMMAND tcppump ${DEFAULT_PARAMS} -s ${TEST_FILE_PREFIX}/loop-02.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(loop-02--nok PROPERTIES PASS_REGULAR_EXPRESSION "Missing matching \{\")
add_test(NAME loop-03--nok COMMAND tcppump ${DEFAULT_PARAMS} -s ${TEST_FILE_PREFIX}/loop-03.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(loop-03--nok PROPERTIES PASS_REGULAR_EXPRESSION "Missing matching \{\")
add_test(NAME loop-04--nok COMMAND tcppump ${DEFAULT_PARAMS} -s ${TEST_FILE_PREFIX}/loop-04.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(loop-04--nok PROPERTIES PASS_REGULAR_EXPRESSION "Missing matching \{\")
add_test(NAME loop-05--nok COMMAND tcppump ${DEFAULT_PARAMS} -s ${TEST_FILE_PREFIX}/loop-05.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
set_tests_properties(loop-05--nok PROPERTIES PASS_REGULAR_EXPRESSION "Expected \}\ at end of input")
add_test(NAME loop-06--ok COMMAND tcppump ${DEFAULT_PARAMS} -s ${TEST_FILE_PREFIX}/loop-06.pump WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
# TODO loop-06--diff

add_test(NAME pcap-1--ok COMMAND tcppump ${DEFAULT_PARAMS} --pcap ${TEST_FILE_PREFIX}/delay-13.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME pcap-1--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/delay-13.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME pcap-2--ok COMMAND tcppump ${DEFAULT_PARAMS} --pcap ${TEST_FILE_PREFIX}/delay-18.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME pcap-2--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/pcap-02.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME pcap-3--ok COMMAND tcppump ${DEFAULT_PARAMS} --pcap=0.5 ${TEST_FILE_PREFIX}/delay-13.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME pcap-3--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/pcap-03.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME pcap-4--ok COMMAND tcppump ${DEFAULT_PARAMS} --pcap=2 ${TEST_FILE_PREFIX}/delay-13.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME pcap-4--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/pcap-04.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME pcap-5--ok COMMAND tcppump ${DEFAULT_PARAMS} --pcap=0 ${TEST_FILE_PREFIX}/delay-13.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
add_test(NAME pcap-5--ok--diff COMMAND cmake -E compare_files ${TEST_OUTPUT} ${TEST_FILE_PREFIX}/pcap-05.pcap WORKING_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})
